{% load static %}
<header class="main-header">
    <div class="header-container">
        <div class="logo-brand">
            <a href="/">
                <span class="brand-name">AURA ESSENCE</span>
            </a>
        </div>

        <div class="search-wrapper">
            <form action="?" method="get">
                <input type="search" name="q" placeholder="Buscar perfumes, aromas, productos...">
                <button type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
            </form>
        </div>

        <nav class="header-actions">
            {% if user.is_authenticated %}
                <div class="user-menu">
                    <a href="/perfil/" title="Mi Perfil" class="action-icon">
                        <i class="fa-regular fa-user"></i>
                    </a>
                    <a href="{% url 'auth:logout' %}" title="Cerrar Sesión" class="action-icon">
                        <i class="fa-solid fa-sign-out-alt"></i>
                    </a>
                </div>
            {% else %}
                <a href="{% url 'auth:login' %}" title="Iniciar Sesión" class="action-icon">
                    <i class="fa-regular fa-user"></i>
                </a>
            {% endif %}
            
            <a href="{% url 'carrito' %}" title="Carrito" class="action-icon cart-trigger">
                <i class="fa-solid fa-cart-shopping"></i>
                <span class="cart-badge">{{ carrito_items_count|default:0 }}</span>
            </a>
            
            <button id="dark-mode-toggle" class="theme-btn" title="Cambiar modo">
                <i class="fa-solid fa-moon"></i> 
            </button>
        </nav>
    </div>
</header>

<script>
    // Dark mode toggle script
    const btn = document.getElementById('dark-mode-toggle');
    if (btn) {
        const icon = btn.querySelector('i');
        
        // Revisar si ya existía una preferencia guardada
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-mode');
            icon.classList.replace('fa-moon', 'fa-sun');
        }

        btn.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            
            // Cambiar el icono y guardar preferencia
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.replace('fa-moon', 'fa-sun');
                localStorage.setItem('theme', 'dark');
            } else {
                icon.classList.replace('fa-sun', 'fa-moon');
                localStorage.setItem('theme', 'light');
            }
        });
    }
</script>
